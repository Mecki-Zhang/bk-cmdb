webpackJsonp([8],{"3h5T":function(e,t,i){t=e.exports=i("UTlt")(!0),t.push([e.i,".process-wrapper[data-v-2da6bb96]{padding:20px}.process-filter .filter-selector[data-v-2da6bb96]{width:170px;margin-right:10px}.process-filter .filter-text[data-v-2da6bb96]{position:relative}.process-filter .filter-text .bk-form-input[data-v-2da6bb96]{width:320px}.process-filter .filter-text .icon-search[data-v-2da6bb96]{position:absolute;right:10px;top:11px;cursor:pointer}.process-table[data-v-2da6bb96]{margin-top:20px}.tab-wrapper[data-v-2da6bb96]{height:calc(100% - 60px);padding:0 20px}.tab-wrapper.attribute[data-v-2da6bb96]{height:calc(100% - 121px)}","",{version:3,sources:["/data/bk-cmdb/src/configcenter/src/ui/src/pages/process/process.vue"],names:[],mappings:"AAoBA,kCACE,YAAc,CACf,AACD,kDACE,YAAa,AACb,iBAAmB,CACpB,AACD,8CACE,iBAAmB,CACpB,AACD,6DACI,WAAa,CAChB,AACD,2DACI,kBAAmB,AACnB,WAAY,AACZ,SAAU,AACV,cAAgB,CACnB,AACD,gCACE,eAAiB,CAClB,AACD,8BACE,yBAA0B,AAC1B,cAAgB,CACjB,AACD,wCACI,yBAA2B,CAC9B",file:"process.vue",sourcesContent:['\n@charset "UTF-8";\n/*\r\n * Tencent is pleased to support the open source community by making 蓝鲸 available.\r\n * Copyright (C) 2017-2018 THL A29 Limited, a Tencent company. All rights reserved.\r\n * Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at http://opensource.org/licenses/MIT\r\n * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and limitations under the License.\r\n */\n/*\r\n * Tencent is pleased to support the open source community by making 蓝鲸 available.\r\n * Copyright (C) 2017-2018 THL A29 Limited, a Tencent company. All rights reserved.\r\n * Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at http://opensource.org/licenses/MIT\r\n * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and limitations under the License.\r\n */\n.process-wrapper[data-v-2da6bb96] {\n  padding: 20px;\n}\n.process-filter .filter-selector[data-v-2da6bb96] {\n  width: 170px;\n  margin-right: 10px;\n}\n.process-filter .filter-text[data-v-2da6bb96] {\n  position: relative;\n}\n.process-filter .filter-text .bk-form-input[data-v-2da6bb96] {\n    width: 320px;\n}\n.process-filter .filter-text .icon-search[data-v-2da6bb96] {\n    position: absolute;\n    right: 10px;\n    top: 11px;\n    cursor: pointer;\n}\n.process-table[data-v-2da6bb96] {\n  margin-top: 20px;\n}\n.tab-wrapper[data-v-2da6bb96] {\n  height: calc(100% - 60px);\n  padding: 0 20px;\n}\n.tab-wrapper.attribute[data-v-2da6bb96] {\n    height: calc(100% - 121px);\n}\n'],sourceRoot:""}])},"8NdT":function(e,t,i){"use strict";var s=i("4YfN"),r=i.n(s),a=i("9rMa"),n=i("7iic");t.a={props:{bkProcessId:{required:!0},bkBizId:{required:!0}},data:function(){return{table:{header:[{id:"bk_module_name",name:"模块名"},{id:"set_num",name:"所属集群数"},{id:"is_bind",name:"状态"}],list:[],isLoading:!1,maxHeight:0}}},computed:r()({},Object(a.c)(["bkSupplierAccount"])),watch:{bkProcessId:function(e){this.getModuleList()}},methods:{changeBinding:function(e){var t=this,i=e.bk_module_name.replace(" ","");0===e.is_bind?this.$axios.put("proc/module/"+this.bkSupplierAccount+"/"+this.bkBizId+"/"+this.bkProcessId+"/"+i).then(function(e){e.result?(t.$alertMsg("绑定进程到该模块成功","success"),t.getModuleList()):t.$alertMsg("绑定进程到该模块失败")}):this.$axios.delete("proc/module/"+this.bkSupplierAccount+"/"+this.bkBizId+"/"+this.bkProcessId+"/"+i).then(function(e){e.result?(t.$alertMsg("解绑进程模块成功","success"),t.getModuleList()):t.$alertMsg("解绑进程模块失败")})},getModuleList:function(){var e=this;this.isLoading=!0,this.$axios.get("proc/module/"+this.bkSupplierAccount+"/"+this.bkBizId+"/"+this.bkProcessId).then(function(t){t.result?e.table.list=t.data:e.$alertMsg(t.bk_error_msg),e.calcMaxHeight(),e.isLoading=!1}).catch(function(){e.isLoading=!1})},calcMaxHeight:function(){this.table.maxHeight=document.body.getBoundingClientRect().height-160}},components:{vTable:n.a}}},Dnji:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"process-wrapper"},[i("div",{staticClass:"process-filter clearfix"},[i("v-application-selector",{staticClass:"filter-selector fl",attrs:{filterable:!0,selected:e.filter.bkBizId},on:{"update:selected":function(t){e.$set(e.filter,"bkBizId",t)}}}),e._v(" "),i("bk-button",{staticClass:"fl",attrs:{type:"primary"},on:{click:e.createProcess}},[e._v("新增进程")]),e._v(" "),i("div",{staticClass:"filter-text fr"},[i("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.filter.text,expression:"filter.text",modifiers:{trim:!0}}],staticClass:"bk-form-input",attrs:{type:"text",placeholder:"进程名称搜索"},domProps:{value:e.filter.text},on:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.setCurrentPage(1)},input:function(t){t.target.composing||e.$set(e.filter,"text",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),e._v(" "),i("i",{staticClass:"bk-icon icon-search",on:{click:function(t){e.setCurrentPage(1)}}})])],1),e._v(" "),i("v-table",{staticClass:"process-table",attrs:{tableHeader:e.table.header,tableList:e.table.list,defaultSort:e.table.defaultSort,pagination:e.table.pagination,isLoading:e.table.isLoading},on:{handlePageTurning:e.setCurrentPage,handlePageSizeChange:e.setCurrentSize,handleTableSortClick:e.setCurrentSort,handleRowClick:e.showProcessAttribute}}),e._v(" "),i("v-side-slider",{attrs:{isShow:e.slider.isShow,title:e.slider.title},on:{"update:isShow":function(t){e.$set(e.slider,"isShow",t)}}},[i("bk-tab",{class:["tab-wrapper",e.slider.tab.active],attrs:{slot:"content","active-name":e.slider.tab.active},on:{"tab-changed":e.tabChanged},slot:"content"},[i("bk-tabpanel",{attrs:{name:"attribute",title:"属性"}},[i("v-attribute",{attrs:{active:e.slider.isShow&&"attribute"===e.slider.tab.active,type:e.slider.tab.attribute.type,formFields:e.attribute,formValues:e.slider.tab.attribute.formValues,objId:"process"},on:{submit:e.saveProcess,delete:e.deleteProcess}})],1),e._v(" "),i("bk-tabpanel",{attrs:{name:"bind",title:"模块绑定",show:"update"===e.slider.tab.type}},[i("v-module",{attrs:{bkProcessId:e.slider.tab.module.bkProcessId,bkBizId:e.filter.bkBizId}})],1),e._v(" "),i("bk-tabpanel",{attrs:{name:"history",title:"变更记录",show:"update"===e.slider.tab.type}},[i("v-history",{attrs:{active:"history"===e.slider.tab.active,type:"process",instId:e.slider.tab.history.bkProcessId}})],1)],1)],1)],1)},r=[],a={render:s,staticRenderFns:r};t.a=a},LX39:function(e,t,i){"use strict";var s=i("4YfN"),r=i.n(s),a=i("WXyl"),n=i("7iic"),o=i("d0Hl"),c=i("vRoO"),l=i("uMlJ"),d=i("eoyL"),u=i("9rMa");t.a={data:function(){return{filter:{bkBizId:"",text:""},attribute:[],table:{header:[],list:[],pagination:{current:1,count:0,size:10},defaultSort:"-bk_process_id",sort:"-bk_process_id",isLoading:!1},slider:{isShow:!1,title:{text:"新增进程",icon:"icon-cc-cube-entity"},tab:{active:"attribute",type:"create",attribute:{type:"create",formValues:{}},module:{bkProcessId:0},history:{bkProcessId:0}}}}},computed:r()({},Object(u.c)(["bkSupplierAccount"]),{searchParams:function(){var e={condition:{bk_biz_id:this.filter.bkBizId},fields:[],page:{start:(this.table.pagination.current-1)*this.table.pagination.size,limit:this.table.pagination.size,sort:this.table.sort}};return this.filter.text&&(e.condition.bk_process_name=this.filter.text),e}}),watch:{attribute:function(e){var t=[],i=[],s=[];e.map(function(e){var r=e.isonly,a=e.isrequired,n=e.bk_property_id,o=e.bk_property_name,c={id:n,name:o};r&&a?t.push(c):r||r?i.push(c):s.push(c)}),this.table.header=t.concat(i,s).slice(0,6)},"filter.bkBizId":function(e){var t=this;this.$nextTick(function(){t.setCurrentPage(1)})}},methods:{createProcess:function(){this.slider.title.text="新增进程",this.slider.tab.active="attribute",this.slider.tab.type="create",this.slider.tab.attribute.type="create",this.slider.tab.attribute.formValues={},this.slider.isShow=!0},saveProcess:function(e,t){var i=this;"create"===this.slider.tab.attribute.type?this.$axios.post("proc/"+this.bkSupplierAccount+"/"+this.filter.bkBizId,e).then(function(e){e.result?(i.$alertMsg("新增进程成功","success"),i.setCurrentPage(1),i.closeSlider()):i.$alertMsg(e.bk_error_msg)}):this.$axios.put("proc/"+this.bkSupplierAccount+"/"+this.filter.bkBizId+"/"+t.bk_process_id,e).then(function(e){e.result?(i.$alertMsg("修改进程成功","success"),i.setCurrentPage(1),i.closeSlider()):i.$alertMsg(e.bk_error_msg)})},deleteProcess:function(e){var t=this;this.$bkInfo({title:"确认要删除进程"+e.bk_process_name,confirmFn:function(){t.$axios.delete("proc/"+t.bkSupplierAccount+"/"+t.filter.bkBizId+"/"+e.bk_process_id).then(function(e){e.result?(t.closeSlider(),t.setCurrentPage(1),t.$alertMsg("删除进程成功","success")):t.$alertMsg(e.bk_error_msg)})}})},showProcessAttribute:function(e){var t=this;this.slider.title.text="编辑进程",this.slider.tab.active="attribute",this.slider.tab.type="update",this.slider.tab.attribute.type="update",this.slider.tab.attribute.formValues={},this.slider.tab.module.bkProcessId=e.bk_process_id,this.slider.tab.history.bkProcessId=e.bk_process_id,this.slider.isShow=!0,this.$axios.get("proc/"+this.bkSupplierAccount+"/"+this.filter.bkBizId+"/"+e.bk_process_id).then(function(i){if(i.result){var s={bk_process_id:e.bk_process_id};i.data.map(function(e){s[e.bk_property_id]=e.bk_property_value}),t.slider.tab.attribute.formValues=s}else t.$alertMsg(i.bk_error_msg)})},tabChanged:function(e){this.slider.tab.active=e},getProcessAttribute:function(){var e=this,t={bk_obj_id:"process",bk_supplier_account:this.bkSupplierAccount};this.$axios.post("object/attr/search",t).then(function(t){t.result?e.attribute=t.data:e.$alertMsg(t.bk_error_msg)})},getTableList:function(){var e=this;this.table.isLoading=!0,this.$axios.post("proc/search/"+this.bkSupplierAccount+"/"+this.filter.bkBizId,this.searchParams).then(function(t){t.result?(e.table.list=t.data.info,e.table.pagination.count=t.data.count):e.$alertMsg(t.bk_error_msg),e.table.isLoading=!1}).catch(function(t){e.table.isLoading=!1,e.table.list=[],t.response&&403===t.response.status&&e.$alertMsg("您没有当前业务的权限")})},setCurrentSize:function(e){this.table.pagination.size=e,this.setCurrentPage(1)},setCurrentSort:function(e){this.table.sort=e,this.setCurrentPage(1)},setCurrentPage:function(e){this.table.pagination.current=e,this.getTableList()},closeSlider:function(){this.slider.isShow=!1}},created:function(){this.getProcessAttribute()},components:{vApplicationSelector:a.a,vTable:n.a,vSideSlider:o.a,vAttribute:c.a,vModule:d.a,vHistory:l.a}}},NmSg:function(e,t,i){"use strict";function s(e){i("YCLc")}Object.defineProperty(t,"__esModule",{value:!0});var r=i("LX39"),a=i("Dnji"),n=i("Z0/y"),o=s,c=n(r.a,a.a,!1,o,"data-v-2da6bb96",null);t.default=c.exports},RBhA:function(e,t,i){var s=i("kCr0");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("FIqI")("3ca24467",s,!0,{})},YCLc:function(e,t,i){var s=i("3h5T");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);i("FIqI")("365806c9",s,!0,{})},eoyL:function(e,t,i){"use strict";function s(e){i("RBhA")}var r=i("8NdT"),a=i("wZuC"),n=i("Z0/y"),o=s,c=n(r.a,a.a,!1,o,"data-v-347eefc4",null);t.a=c.exports},kCr0:function(e,t,i){t=e.exports=i("UTlt")(!0),t.push([e.i,".module-table[data-v-347eefc4]{padding:20px 0 0}.module-table .btn[data-v-347eefc4]{width:52px;height:25px}","",{version:3,sources:["/data/bk-cmdb/src/configcenter/src/ui/src/pages/process/children/module.vue"],names:[],mappings:"AAoBA,+BACE,gBAAoB,CACrB,AACD,oCACI,WAAY,AACZ,WAAa,CAChB",file:"module.vue",sourcesContent:['\n@charset "UTF-8";\n/*\r\n * Tencent is pleased to support the open source community by making 蓝鲸 available.\r\n * Copyright (C) 2017-2018 THL A29 Limited, a Tencent company. All rights reserved.\r\n * Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at http://opensource.org/licenses/MIT\r\n * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and limitations under the License.\r\n */\n/*\r\n * Tencent is pleased to support the open source community by making 蓝鲸 available.\r\n * Copyright (C) 2017-2018 THL A29 Limited, a Tencent company. All rights reserved.\r\n * Licensed under the MIT License (the "License"); you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at http://opensource.org/licenses/MIT\r\n * Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and limitations under the License.\r\n */\n.module-table[data-v-347eefc4] {\n  padding: 20px 0 0 0;\n}\n.module-table .btn[data-v-347eefc4] {\n    width: 52px;\n    height: 25px;\n}\n'],sourceRoot:""}])},wZuC:function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-table",{staticClass:"module-table",attrs:{tableHeader:e.table.header,tableList:e.table.list,isLoading:e.table.isLoading,maxHeight:e.table.maxHeight,sortable:!1},scopedSlots:e._u([{key:"is_bind",fn:function(t){var s=t.item;return i("td",{},[i("button",{class:s.is_bind?"main-btn":"vice-btn",on:{click:function(t){e.changeBinding(s)}}},[e._v("\n            "+e._s(s.is_bind?"已绑定":"未绑定")+"\n        ")])])}}])})},r=[],a={render:s,staticRenderFns:r};t.a=a}});
//# sourceMappingURL=8.d1a334e36158ea2de1b8.js.map